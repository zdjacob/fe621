
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>BlackScholes_Call_Price_Using_FFT</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-04-21"><meta name="DC.source" content="BlackScholes_Call_Price_Using_FFT.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="comment">% Fast Fourier Transform for the Black Scholes Model</span>

<span class="comment">% --------------------------------------</span>
<span class="comment">% Inputs</span>
<span class="comment">%   N  = number of discretization points</span>
<span class="comment">%   uplimit = Upper limit of integration</span>
<span class="comment">%   S0 = spot price</span>
<span class="comment">%   r = risk free rate</span>
<span class="comment">%   tau = maturity</span>
<span class="comment">%   sigma = volatility</span>
<span class="comment">%   alpha = dampening factor</span>
<span class="comment">%   fast = fast versus slow algorithm.</span>
<span class="comment">%     fast = 1 fast version.  Uses vectorization.</span>
<span class="comment">%     fast = 0 slow version.  Uses loops</span>
<span class="comment">% --------------------------------------</span>
<span class="comment">% Outputs</span>
<span class="comment">%   CallFFT = Black Scholes call prices using FFT</span>
<span class="comment">%   CallBS  = Black Scholes call prices using closed form</span>
<span class="comment">%         K = Strike prices</span>
<span class="comment">%       eta = increment for integration range</span>
<span class="comment">%    lambda = increment for log-strike range</span>
<span class="comment">% --------------------------------------</span>
<span class="comment">% By Fabrice Douglas Rouah www.Volopta.com</span>

clc; clear;

<span class="comment">% Required inputs</span>
S0 = 10;           <span class="comment">% Spot price.</span>
r = 0.0;           <span class="comment">% Risk free rate.</span>
q = 0.0;           <span class="comment">% Dividend yield</span>
tau = .5;          <span class="comment">% Time to maturity.</span>
sigma = 0.3;       <span class="comment">% Volatility</span>
alpha = 1.75;      <span class="comment">% Dampening factor</span>
N = 128;            <span class="comment">% Grid size</span>
uplimit = 200;      <span class="comment">% Upper limit of integration</span>
fast = 0;           <span class="comment">% Choice of fast or slow algorithm</span>

<span class="comment">% Run the Fast Fourier Transform</span>
[CallFFT CallBS K lambda eta] = BlackScholesFFT(N,uplimit,S0,r,q,tau,sigma,alpha,fast);

<span class="comment">% Print the results near the ATM strikes</span>
u1 = find(round(K*1000)/1000==S0);
du = 15;
[K(u1-du:u1+du) CallFFT(u1-du:u1+du) CallBS(u1-du:u1+du)]

<span class="comment">% Print the increments for integration and for log strikes</span>
IntegrationIncrement = eta
LogStrikeIncrement = lambda
NumberOfPoints = N
</pre><pre class="codeoutput">
ans =

    6.2423    3.7741    3.7654
    6.4415    3.5790    3.5703
    6.6471    3.3794    3.3707
    6.8592    3.1759    3.1672
    7.0781    2.9691    2.9604
    7.3040    2.7599    2.7512
    7.5371    2.5494    2.5407
    7.7777    2.3389    2.3302
    8.0259    2.1298    2.1212
    8.2820    1.9239    1.9153
    8.5464    1.7229    1.7143
    8.8191    1.5287    1.5201
    9.1006    1.3430    1.3344
    9.3910    1.1676    1.1590
    9.6907    1.0040    0.9953
   10.0000    0.8533    0.8447
   10.3191    0.7166    0.7080
   10.6485    0.5943    0.5857
   10.9883    0.4866    0.4780
   11.3390    0.3932    0.3846
   11.7009    0.3136    0.3050
   12.0743    0.2468    0.2382
   12.4597    0.1918    0.1832
   12.8573    0.1473    0.1387
   13.2676    0.1119    0.1033
   13.6911    0.0842    0.0757
   14.1280    0.0630    0.0545
   14.5789    0.0471    0.0386
   15.0442    0.0354    0.0268
   15.5243    0.0269    0.0183
   16.0198    0.0208    0.0123


IntegrationIncrement =

    1.5625


LogStrikeIncrement =

    0.0314


NumberOfPoints =

   128

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
% Fast Fourier Transform for the Black Scholes Model

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Inputs
%   N  = number of discretization points
%   uplimit = Upper limit of integration
%   S0 = spot price
%   r = risk free rate
%   tau = maturity
%   sigma = volatility
%   alpha = dampening factor
%   fast = fast versus slow algorithm.
%     fast = 1 fast version.  Uses vectorization.
%     fast = 0 slow version.  Uses loops
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Outputs
%   CallFFT = Black Scholes call prices using FFT
%   CallBS  = Black Scholes call prices using closed form
%         K = Strike prices
%       eta = increment for integration range
%    lambda = increment for log-strike range
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% By Fabrice Douglas Rouah www.Volopta.com
 
clc; clear;

% Required inputs
S0 = 10;           % Spot price.
r = 0.0;           % Risk free rate.
q = 0.0;           % Dividend yield
tau = .5;          % Time to maturity.
sigma = 0.3;       % Volatility
alpha = 1.75;      % Dampening factor
N = 128;            % Grid size
uplimit = 200;      % Upper limit of integration
fast = 0;           % Choice of fast or slow algorithm

% Run the Fast Fourier Transform
[CallFFT CallBS K lambda eta] = BlackScholesFFT(N,uplimit,S0,r,q,tau,sigma,alpha,fast);

% Print the results near the ATM strikes
u1 = find(round(K*1000)/1000==S0);
du = 15;
[K(u1-du:u1+du) CallFFT(u1-du:u1+du) CallBS(u1-du:u1+du)]

% Print the increments for integration and for log strikes
IntegrationIncrement = eta
LogStrikeIncrement = lambda
NumberOfPoints = N


##### SOURCE END #####
--></body></html>